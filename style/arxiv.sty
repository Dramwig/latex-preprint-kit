\NeedsTeXFormat{LaTeX2e}

\ProcessOptions\relax

% fonts
\renewcommand{\rmdefault}{ptm}
\renewcommand{\sfdefault}{phv}

% set page geometry
\usepackage[verbose=true,letterpaper]{geometry}
\AtBeginDocument{%
  \if@twocolumn
    \newgeometry{%
      textwidth=6.875in,
      textheight=8.875in,
      columnsep=0.3125in,
    }%
  \else
    \newgeometry{%
      textwidth=6.5in,
      textheight=9in,
      top=1in,
      headheight=14pt,
      headsep=25pt,
      footskip=30pt
    }%
  \fi
}


\widowpenalty=10000
\clubpenalty=10000
\flushbottom
\sloppy

%Handling Keywords
\def\keywordname{{\bfseries \emph{Keywords}}}%
\def\keywords#1{\par\addvspace\medskipamount{\rightskip=0pt plus1cm
\def\and{\ifhmode\unskip\nobreak\fi\ $\cdot$
}\noindent\keywordname\enspace\ignorespaces#1\par}}

% sections with less space
\providecommand{\section}{}
\renewcommand{\section}{%
  \@startsection{section}{1}{\z@}%
                {-2.0ex \@plus -0.5ex \@minus -0.2ex}%
                { 1.5ex \@plus  0.3ex \@minus  0.2ex}%
                {\large\bf\raggedright}%
}
\providecommand{\subsection}{}
\renewcommand{\subsection}{%
  \@startsection{subsection}{2}{\z@}%
                {-1.8ex \@plus -0.5ex \@minus -0.2ex}%
                { 0.8ex \@plus  0.2ex}%
                {\normalsize\bf\raggedright}%
}
\providecommand{\subsubsection}{}
\renewcommand{\subsubsection}{%
  \@startsection{subsubsection}{3}{\z@}%
                {-1.5ex \@plus -0.5ex \@minus -0.2ex}%
                { 0.5ex \@plus  0.2ex}%
                {\normalsize\bf\raggedright}%
}
\providecommand{\paragraph}{}
\renewcommand{\paragraph}{%
  \@startsection{paragraph}{4}{\z@}%
                {1.5ex \@plus 0.5ex \@minus 0.2ex}%
                {-1em}%
                {\normalsize\bf}%
}
\providecommand{\subparagraph}{}
\renewcommand{\subparagraph}{%
  \@startsection{subparagraph}{5}{\z@}%
                {1.5ex \@plus 0.5ex \@minus 0.2ex}%
                {-1em}%
                {\normalsize\bf}%
}
\providecommand{\subsubsubsection}{}
\renewcommand{\subsubsubsection}{%
  \vskip5pt{\noindent\normalsize\rm\raggedright}%
}

% float placement
\renewcommand{\topfraction      }{0.85}
\renewcommand{\bottomfraction   }{0.4}
\renewcommand{\textfraction     }{0.1}
\renewcommand{\floatpagefraction}{0.7}

\newlength{\@abovecaptionskip}\setlength{\@abovecaptionskip}{7\p@}
\newlength{\@belowcaptionskip}\setlength{\@belowcaptionskip}{\z@}

\setlength{\abovecaptionskip}{\@abovecaptionskip}
\setlength{\belowcaptionskip}{\@belowcaptionskip}

% swap above/belowcaptionskip lengths for tables
\renewenvironment{table}
  {\setlength{\abovecaptionskip}{\@belowcaptionskip}%
   \setlength{\belowcaptionskip}{\@abovecaptionskip}%
   \@float{table}}
  {\end@float}

% footnote formatting
\setlength{\footnotesep }{6.65\p@}
\setlength{\skip\footins}{9\p@ \@plus 4\p@ \@minus 2\p@}
\renewcommand{\footnoterule}{\kern-3\p@ \hrule width 12pc \kern 2.6\p@}
\setcounter{footnote}{0}

% paragraph formatting
\if@twocolumn
  \setlength{\parskip}{5.5\p@}
  \setlength{\parindent}{\z@}
\else
  \setlength{\parskip  }{5.5\p@}
  \setlength{\parindent}{\z@}
\fi

% list formatting
\setlength{\topsep       }{4\p@ \@plus 1\p@   \@minus 2\p@}
\setlength{\partopsep    }{1\p@ \@plus 0.5\p@ \@minus 0.5\p@}
\setlength{\itemsep      }{2\p@ \@plus 1\p@   \@minus 0.5\p@}
\setlength{\parsep       }{2\p@ \@plus 1\p@   \@minus 0.5\p@}
\setlength{\leftmargin   }{3pc}
\setlength{\leftmargini  }{\leftmargin}
\setlength{\leftmarginii }{2em}
\setlength{\leftmarginiii}{1.5em}
\setlength{\leftmarginiv }{1.0em}
\setlength{\leftmarginv  }{0.5em}
\def\@listi  {\leftmargin\leftmargini}
\def\@listii {\leftmargin\leftmarginii
              \labelwidth\leftmarginii
              \advance\labelwidth-\labelsep
              \topsep  2\p@ \@plus 1\p@    \@minus 0.5\p@
              \parsep  1\p@ \@plus 0.5\p@ \@minus 0.5\p@
              \itemsep \parsep}
\def\@listiii{\leftmargin\leftmarginiii
              \labelwidth\leftmarginiii
              \advance\labelwidth-\labelsep
              \topsep    1\p@ \@plus 0.5\p@ \@minus 0.5\p@
              \parsep    \z@
              \partopsep 0.5\p@ \@plus 0\p@ \@minus 0.5\p@
              \itemsep \topsep}
\def\@listiv {\leftmargin\leftmarginiv
              \labelwidth\leftmarginiv
              \advance\labelwidth-\labelsep}
\def\@listv  {\leftmargin\leftmarginv
              \labelwidth\leftmarginv
              \advance\labelwidth-\labelsep}
\def\@listvi {\leftmargin\leftmarginvi
              \labelwidth\leftmarginvi
              \advance\labelwidth-\labelsep}


% create title with auther
\def\@affiliations{}    % 机构行
\def\@emailline{}       % 邮箱行
\def\@footline{}       % 邮箱行
\newcommand{\affiliations}[1]{\gdef\@affiliations{#1}}
\newcommand{\emailline}[1]{\gdef\@emailline{#1}}
\newcommand{\footline}[1]{\gdef\@footline{#1}}

\newcommand{\affmark}[1]{\textsuperscript{#1}} % 机构角标 1,2,...
\newcommand{\foottext}[2]{\footnotetext[#1]{#2}}
\newcommand{\footlabel}[1]{%
  \begingroup
    \setcounter{footnote}{#1}%
    \thefootnote
  \endgroup
}

\providecommand{\@maketitle}{}
\renewcommand{\@maketitle}{%
  \begingroup
    \begin{center}
      {\LARGE \bfseries \@title \par}
      \vspace{1.2em}
      {\large \@author \par}           % 这里直接排作者行（自带上标/脚注标记）
      \vspace{0.8em}
      {\small \@affiliations \\}     % 机构行
      {\ttfamily \@emailline \par}     % 邮箱行
    \end{center}
    \@footline
  \endgroup
  \par\vskip 1.5em
}

% add conference notice to bottom of first page
\newcommand{\ftype@noticebox}{8}
\newcommand{\@notice}{%
  % give a bit of extra room back to authors on first page
  \enlargethispage{2\baselineskip}%
  \@float{noticebox}[b]%
    \footnotesize\@noticestring%
  \end@float%
}

% abstract styling
\renewenvironment{abstract}
{%
  \centerline{\large\bf Abstract}%
  \if@twocolumn
    \vspace{12pt}%
    \noindent\it\ignorespaces
  \else
    \vspace{-6pt}%
    \begin{quote}\it\ignorespaces
  \fi
}
{%
  \if@twocolumn
    \vspace{12pt}%
  \else
    \end{quote}
  \fi
}

% ---------------------------------------------------------------

%% redefine the \title command so that a variable name is saved in \thetitle, and provides the \maketitlesupplementary command
\let\titleold\title
\renewcommand{\title}[1]{\titleold{#1}\newcommand{\thetitle}{#1}}
\newcommand{\maketitlesupplementary}{%
  \clearpage
  \if@twocolumn
    \twocolumn[{%
      \centering
      \Large
      \textbf{\thetitle}\\
      \vspace{0.5em}Supplementary Material\par
      \vspace{1em}
    }]%
  \else
    {      
      \centering
      \Large
      \textbf{\thetitle}\\
      \vspace{0.5em}Supplementary Material\par
      \vspace{1em}
    }
  \fi
}

\endinput
